#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ğŸ”§ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙŠÙ†Ø¯Ø± - Ù†Ø¸Ø§Ù… Ù…Ù†ÙØµÙ„ Ù…Ø¹ Burst Mode Monitoring
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… Ø²Ø± ØªÙØ§Ø¹Ù„ÙŠ ÙÙŠ Ø¬Ø±ÙˆØ¨ "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª" ÙÙ‚Ø·
âœ… Ù†Ø¸Ø§Ù… Ù…Ø±Ù† Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (email, password, backup)
âœ… Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
âœ… ğŸ†• Burst Mode monitoring Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
âœ… ğŸ†• Smart Edit Summary - Ø±Ø³Ø§Ù„Ø© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
âœ… ğŸ†• Execute Button Monitoring - Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
âœ… ğŸ†• Google Sheets Edit Queue - ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙÙˆÙ Ø¨Ø¯Ù„ Ø§Ù„ØªÙƒØ±Ø§Ø±
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
"""

import asyncio
import json
import re
from typing import Dict, Optional, Tuple

import aiohttp
from telegram import InlineKeyboardButton, InlineKeyboardMarkup

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âš™ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

with open("config.json", "r", encoding="utf-8") as f:
    CONFIG = json.load(f)

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ø±ÙˆØ¨ "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª"
ALL_STATES_GROUP_ID = None
for group in CONFIG.get("notification_groups", {}).get("groups", []):
    if group.get("name") == "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª":
        ALL_STATES_GROUP_ID = group.get("group_id")
        break

# Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
WEBSITE_CONFIG = CONFIG.get("website", {})
BASE_URL = WEBSITE_CONFIG.get("urls", {}).get("base", "https://utautotransfer.com")
COOKIES = WEBSITE_CONFIG.get("cookies", {})

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ†• Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

from core import monitor_account_task

# ğŸ“Š Global vars
api_manager_instance = None  # ğŸ†• Ø³ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡ Ù…Ù† main.py Ø¹Ù†Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„


def set_api_manager(api_mgr):
    """Ø¯Ø§Ù„Ø© Ù„ØªØ¹ÙŠÙŠÙ† api_manager Ù…Ù† main.py"""
    global api_manager_instance
    api_manager_instance = api_mgr
